<% 
const LINKS = [
  {name: 'Home', icon: './icons/home', href: '/'},
  {name: 'Explore', icon: './icons/explore', href: '/search'},
  {name: 'Profile', icon: './icons/profile', href: '/auth/profile'},
  {name: 'Users', icon: './icons/users', href: '/auth/users'},

]
%>

<% const FILTERED_LINKS = locals.currentUser.role === 'admin' ? LINKS :
LINKS.filter(l => l.name !== 'Users') %>

<aside
  class="sm:sticky absolute top-0 left-0 sm:translate-x-0 -translate-x-full w-60 px-3 h-screen bg-white sm:border-none border-r border-zinc-200 z-30 transition-transform duration-200"
>
  <!-- user info -->
  <button
    type="button"
    class="w-full pr-3 flex items-center text-start mt-8 group hover:bg-zinc-50 rounded-full cursor-pointer"
  >
    <!-- image -->
    <span
      class="ml-2 group-hover:ml-0 group-hover:scale-[80%] shrink-0 transition-all duration-100 flex items-center justify-center size-12 bg-white border border-zinc-100 rounded-full text-2xl text-zinc-700"
      aria-hidden="true"
    >
      <%= currentUser.first_name.slice(0,1) %><%=
                  currentUser.last_name.slice(0,1) %>
    </span>

    <div
      class="flex-1 flex justify-between opacity-0 group-hover:opacity-100 group-hover:ml-1 transition-all duration-100"
    >
      <!-- username -->
      <div class="flex flex-col w-32">
        <span class="font-semibold text-sm -mb-1">
          <%= locals.currentUser.first_name%>
        </span>
        <span class="text-xs text-zinc-400 font-light line-clamp-1">
          <%= locals.currentUser.username %>
        </span>
      </div>

      <div class="text-xl flex items-center justify-center">&#8943;</div>
    </div>
  </button>

  <!-- navigation -->
  <nav class="mt-8">
    <ul class="flex flex-col gap-3">
      <% FILTERED_LINKS.map(link => { %>
      <li>
        <a
          href="<%= link.href  %>"
          class="flex items-center gap-2 text-lg w-full h-full px-2 py-2 rounded-md hover:bg-zinc-50 focus:bg-zinc-50 font-light hover:font-semibold focus:font-semibold transition-all duration-200"
        >
          <span class="inline-block size-6 text-zinc-700" aria-hidden="true">
            <%- include(link.icon) %>
          </span>
          <span><%= link.name %></span>
        </a>
      </li>
      <% }) %>
    </ul>
  </nav>

  <!-- Post button -->
  <button
    id="post-trigger"
    type="button"
    class="mt-10 bg-sky-500 py-2 px-5 outline-none text-white text-sm font-semibold rounded-full cursor-pointer transition-colors duration-200 hover:bg-sky-400 focus:ring-2 focus:ring-offset-1 focus:ring-sky-400 flex items-center justify-center gap-1"
  >
    <span class="inline-block size-5"><%- include('./icons/post') %></span>
    New Post
  </button>
</aside>

<script type="module" src="/scripts/sidebar.js"></script>
